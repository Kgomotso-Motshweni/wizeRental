<p-toast></p-toast>
<p-confirmDialog [style]="{width: '450px'}" header="Confirmation" icon="pi pi-exclamation-triangle"></p-confirmDialog>

<div class="container ">
    <div class="navbar bg-base-100"> 
        <div class="flex-1  ">
            <label for="my-drawer-3"  class="btn btn-ghost btn-circle hidden">
                <i class="pi pi-align-left " style="font-size: 1rem"></i>
            </label>
        </div>
    
        <div class="end-part flex-none justify-end">
            <div class="user mt-3 mr-4">
                <button type="btn" (click)="logIssues()" class="text-white btn-primary focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center dark:btn-primary dark:hover:btn-primary dark:focus:ring-blue-800">My Issues</button>            
            </div>

            <button class="btn ml-4 btn-ghost btn-circle">
                <a (click)="visibleSidebar2 = true" (click)="getNotifications()" >
                    <i class="fa-regular fa-bell"></i>
                    <span class="badge badge-xs badge-primary indicator-item">{{totalNumber}}</span>
                </a> 
            </button>  
        </div>
    </div>
</div>



<!-- The button to open modal -->
<label for="my-modal-5" (click)="getNewTenant()" class="btn modal-button"><i class="bi bi-file-earmark"></i></label>


<!-- Put this part before </body> tag -->
<input type="checkbox" id="my-modal-5" class="modal-toggle" />
<div class="modal" >
  <div class="modal-box w-11/12 max-w-5xl" >
    <h2 class="card-title">Rental Agreement</h2><br>
    <p>On the {{moa_data[0].agreestartdate}}, Agreement between {{moa_data[0].firstname}} {{moa_data[0].lastname}} Owner(s),</p>
    <p>and {{landlordName[0].firstname}} {{landlordName[0].lastname}} , Tenant(s), for dwelling located at {{moa_data[0].p_name}} Location.</p>  
   <p> Tenant(s) agree to rent this dwelling on a month-to-month basis for R {{moa_data[0].amount}}per month,</p> 
   <p>payable on the {{moa_data[0].paystartdate}}day of the calender month.Therefore and in consideration of the mutual promises and agreements<p> 
  <p> contained herein, the Tenant agrees to memorandum the premises from the Landlord under the following.</p><br>
   
   <p><b>TENANTS AGREE TO THE FOLLOWING:</b></p><br>
   <p>
    To keep the yards clean. Not to repair motor vehicles in the premises 
    To pay rent on time and by cash 
    To pay for repairs of all damage, they or thir guests have caused.
    Have no visitors stay for no more than 3 weeks
   </p>

   <p>Tenants hereby acknoledge that they have read this Agreement, understand it agree to it and have been given a copy.</p><br>
   
   <p>Sign here:</p><br>
   
   <!-- <canvas height="80" id="canvas" ></canvas> -->
   <canvas id="canvas"  width="300px">
    

   <input type="text" placeholder="Type here" class="input w-full max-w-xs" />
   </canvas><br>
   <p><button type="submit" (click)="drawClear()" style="background-color:red">Clear signature</button></p>
   <div class="form-group flex justify-end">

    <label for="my-modal-5" class="btn" class =" text-white btn-secondary focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center dark:btn-primary dark:hover:btn-primary dark:focus:ring-blue-800">Close</label>
    <button type="submit" (click)="save(moa_data[0].moa)" class="ml-5 text-white w-44 btn-primary focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center dark:btn-primary dark:hover:btn-primary dark:focus:ring-blue-800">Send</button>
</div>
</div>
</div>


<div class="emptyRoom"  >
    <div class="flex justify-center">
        <div class="grid sm:grid-cols-1 ">
            <div class="card empty w-full shadow-xl">
                <div class="card-body" >
                    <h2 class="card-title">My Room</h2>
                    <div>
                        <h5>Once you have been Accepted you will see your room details here</h5>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="emptyRoom">
    <div class="flex justify-center">
        <div class="grid sm:grid-cols-1 ">
            <div class="card empty w-full shadow-xl"*ngFor="let i of property">
                <div class="card-body"  >
                    <div>
                       <p>{{i.p_address}}</p>  
                         <p>{{i.p_city}}</p> 
                         <p>{{i.p_town}}</p>   
                         <p>{{i.p_zip_code}}</p>  
                         <p>{{i.p_propertytype}}</p> 
                         <p>{{i.paymentstatus}}</p> 
                         <p>Sign memorandum </p>     
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<p-sidebar [(visible)]="visibleSidebar2" position="right" >
    <h1>Notifications from Landlord</h1>
    <app-nortification></app-nortification>
</p-sidebar>

<p-dialog [(visible)]="dialogMessage" [style]="{width: '450px'}" header="Log Issues" [modal]="true" styleClass="p-fluid">
   <form [formGroup]="Form">
        <div class="form-group mb-6">
            <label for="issue1"> Water </label><br>
            <input type="checkbox" formControlName="issues" formid="issue1" name="issue1" value="Water">
            <div *ngIf="submitted && f['issues'].errors" class="invalid-feedback">
                <div *ngIf="f['issues'].errors['required']">message is required</div>
            </div>
        </div>

        <div class="form-group mb-6">
            <label for="issue2"> Electricity </label><br>
            <input type="checkbox" formControlName="issues" id="issue2" name="issue2" value="Electricity"
            [ngClass]="{ 'is-invalid':submitted && f['message'].errors }" >
    
            <div *ngIf="submitted && f['message'].errors" class="invalid-feedback">
                <div *ngIf="f['message'].errors['required']">message is required</div>
            </div>
        </div>

        <div class="form-group mb-6">
            <label for="issue3"> Wifi</label><br>
            <input type="checkbox" formControlName="issues" id="issue3" name="issue3" value="Wifi"
            [ngClass]="{ 'is-invalid':submitted && f['message'].errors }" >
            
            <div *ngIf="submitted && f['message'].errors" class="invalid-feedback">
                <div *ngIf="f['message'].errors['required']">message is required</div>
            </div>
        </div>

        <div class="form-group mb-6">
            <label for="issue4"> Appliance</label><br>
            <input type="checkbox" formControlName="issues" id="issue4" name="issue4" value="Appliance"
            [ngClass]="{ 'is-invalid':submitted && f['message'].errors }" >
            
            <div *ngIf="submitted && f['message'].errors" class="invalid-feedback">
                <div *ngIf="f['message'].errors['required']">message is required</div>
            </div>
        </div>

        <div class="form-group mb-6"> 
            <label class="input-group ">Other:</label>
            <textarea type="text" formControlName="message"
                class="input bg-gray-50 input-bordered w-full email"
                [ngClass]="{ 'is-invalid':submitted && f['message'].errors }" >
            </textarea>        
            <div *ngIf="submitted && f['message'].errors" class="invalid-feedback">
                <div *ngIf="f['message'].errors['required']">message is required</div>
            </div>
        </div>

        <div class="form-group flex justify-end">
            <button type="submit" (click)="hideDialog()" class="text-white btn-secondary focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center dark:btn-primary dark:hover:btn-primary dark:focus:ring-blue-800">Cancel</button>
            <button type="submit" (click)="sendNotification()" class="ml-5 text-white w-44 btn-primary focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center dark:btn-primary dark:hover:btn-primary dark:focus:ring-blue-800">Send</button>
        </div>
      
    </form>
</p-dialog> 

<ngx-loading
    [show]="loading"
    [config]="{
    animationType: ngxLoadingAnimationTypes.threeBounce,
    primaryColour: '#ffffff', secondaryColour: '#ffffff',
    backdropBorderRadius: '3px'
    }">
</ngx-loading>



